digraph testing {
  rankdir="LR";
  newrank=true;

  pop_infected[label="init_infected"];

  // Initial params
  intervention -> cum_infections;
  pop_type -> cum_infections;
  pop_size -> cum_infections;
  pop_infected -> cum_infections;
  start_day -> cum_infections;
  end_day -> cum_infections;
  location -> cum_infections;

  // Other direct affects on infections
  cum_infectious -> cum_infections;
  cum_tests -> cum_infections;

  // Vaccinations
  cum_vaccinations -> cum_infections;
  cum_vaccinated -> cum_infections;
  cum_vaccinations -> cum_vaccinated;
  frac_vaccinated -> cum_infections;
  pop_size -> frac_vaccinated;
  cum_vaccinated -> frac_vaccinated;

  // What is diagnoses?
  cum_infections -> cum_diagnoses;
  cum_tests -> cum_diagnoses;

  // Infection subtypes
  cum_infections -> cum_symptomatic;
  cum_infections -> cum_severe;
  cum_infections -> cum_critical;

  // Death and recovery
  cum_infections -> cum_recoveries;
  cum_infections -> cum_deaths;
  cum_deaths -> cum_known_deaths;

  // Reinfections
  cum_infections -> cum_reinfections;
  cum_deaths -> cum_reinfections;
  cum_recoveries -> cum_reinfections;

  // Other interactions
  cum_quarantined -> cum_infectious;
  cum_tests -> cum_quarantined;
  intervention -> cum_tests;
  intervention -> cum_quarantined;
  pop_size -> cum_quarantined;

  pop_type -> cum_symptomatic;
  pop_type -> cum_severe;
  pop_type -> cum_critical;

  location -> cum_symptomatic;
  location -> cum_severe;
  location -> cum_critical;

  cum_symptomatic -> cum_severe;
  cum_severe -> cum_critical;
  cum_critical -> cum_deaths;




  // Metrics

  // r_eff = (mean_infectious_time * new_infections)/n_infectious
  cum_infectious -> r_eff;
  cum_infections -> r_eff;
  // mean_infectious_time -> r_eff;

  // prevalence - n_exposed / (n_alive = pop_size - n_deaths)
  cum_deaths -> prevalence;
  pop_size -> prevalence;

  // incidence = new_infections / n_susceptible
  cum_infections -> incidence;

  // doubling_time
  cum_infections -> doubling_time;
  start_day -> doubling_time;
  end_day -> doubling_time;

  // test yield
  cum_diagnoses -> test_yield;
  cum_tests -> test_yield;

  test_yield -> rel_test_yield;
  cum_infections -> rel_test_yield;
  pop_size -> rel_test_yield;
  cum_deaths -> rel_test_yield;
  cum_diagnoses -> rel_test_yield;

  // NaB levels (no idea... Seems to be related to number of alive people)
  pop_size -> pop_nabs;
  cum_deaths -> pop_nabs;

  // People with immunity
  cum_infections -> pop_protection;
  cum_recoveries -> pop_protection;
  cum_vaccinated -> pop_protection;

  cum_infections -> pop_symp_protection;
  cum_recoveries -> pop_symp_protection;
  cum_vaccinated -> pop_symp_protection;
  cum_symptomatic -> pop_symp_protection;

}
